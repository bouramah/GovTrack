# üìã Documentation des Mod√®les Eloquent - Module R√©unions

## üéØ Vue d'ensemble

Ce document d√©crit tous les mod√®les Eloquent cr√©√©s pour le module de gestion des r√©unions dans GovTrack. Chaque mod√®le inclut des relations compl√®tes, des constantes ENUM, des scopes de requ√™te, et des accesseurs/mutateurs utiles.

## üìä Mod√®les Cr√©√©s (17 mod√®les)

### 1. **TypeReunion** - Types de r√©unions
**Fichier:** `app/Models/TypeReunion.php`

**Description:** D√©finit les types de r√©unions avec leurs niveaux de complexit√© et configurations.

**Constantes ENUM:**
- `NIVEAU_SIMPLE`, `NIVEAU_INTERMEDIAIRE`, `NIVEAU_COMPLEXE`
- `NIVEAUX` - Mapping des libell√©s

**Relations principales:**
- `gestionnaires()` - BelongsToMany avec User
- `membresPermanents()` - BelongsToMany avec User
- `series()` - HasMany vers ReunionSerie
- `reunions()` - HasMany vers Reunion
- `workflowConfigs()` - HasMany vers ReunionWorkflowConfig
- `validateursPV()` - HasMany vers TypeReunionValidateurPV
- `notificationConfigs()` - HasMany vers ReunionNotificationConfig

**Fonctionnalit√©s:**
- Scopes: `actifs()`, `byNiveauComplexite()`, `ordered()`
- Accesseurs: `niveauComplexiteLibelle`, `niveauComplexiteCouleur`, `niveauComplexiteIcone`
- M√©thodes: `hasFonctionnalite()`, `hasNotification()`

---

### 2. **ReunionSerie** - S√©ries de r√©unions r√©currentes
**Fichier:** `app/Models/ReunionSerie.php`

**Description:** G√®re les s√©ries de r√©unions r√©currentes avec p√©riodicit√©s.

**Constantes ENUM:**
- `PERIODICITE_HEBDOMADAIRE`, `PERIODICITE_BIHEBDOMADAIRE`, `PERIODICITE_MENSUELLE`
- `PERIODICITES` - Mapping des libell√©s

**Relations principales:**
- `typeReunion()` - BelongsTo vers TypeReunion
- `reunionsGenerees()` - HasMany vers ReunionGeneree
- `reunions()` - HasMany vers Reunion
- `createur()` - BelongsTo vers User
- `modificateur()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `actives()`, `nonSuspendues()`, `byPeriodicite()`, `byTypeReunion()`
- Accesseurs: `periodiciteLibelle`, `estEnCours`, `estTerminee`, `estAVenir`
- M√©thodes: `dureeFormatee`, `heureFin`, `generationAutomatiqueActive`

---

### 3. **Reunion** - R√©unions principales
**Fichier:** `app/Models/Reunion.php`

**Description:** Mod√®le principal pour les r√©unions avec toutes leurs propri√©t√©s.

**Constantes ENUM:**
- `NIVEAU_SIMPLE`, `NIVEAU_INTERMEDIAIRE`, `NIVEAU_COMPLEXE`
- `TYPE_LIEU_PHYSIQUE`, `TYPE_LIEU_VIRTUEL`, `TYPE_LIEU_HYBRIDE`
- `PERIODICITE_PONCTUELLE`, `PERIODICITE_HEBDOMADAIRE`, etc.
- `ORDRE_JOUR_EXPLICITE`, `ORDRE_JOUR_IMPLICITE`, `ORDRE_JOUR_HYBRIDE`
- `STATUT_PLANIFIEE`, `STATUT_EN_COURS`, `STATUT_TERMINEE`, `STATUT_ANNULEE`

**Relations principales:**
- `typeReunion()` - BelongsTo vers TypeReunion
- `serie()` - BelongsTo vers ReunionSerie
- `participants()` - HasMany vers ReunionParticipant
- `ordreJours()` - HasMany vers ReunionOrdreJour
- `decisions()` - HasMany vers ReunionDecision
- `pvs()` - HasMany vers ReunionPV
- `notifications()` - HasMany vers ReunionNotification
- `workflowExecutions()` - HasMany vers ReunionWorkflowExecution
- `participantsUsers()` - BelongsToMany vers User

**Fonctionnalit√©s:**
- Scopes: `planifiees()`, `enCours()`, `terminees()`, `annulees()`, `aVenir()`, `passees()`, `aujourdhui()`
- Accesseurs: `statutLibelle`, `niveauComplexiteLibelle`, `typeLieuLibelle`, `dureeFormatee`
- M√©thodes: `quorumAtteint`, `nombreParticipantsPresents`, `hasFonctionnalite()`

---

### 4. **ReunionParticipant** - Participants aux r√©unions
**Fichier:** `app/Models/ReunionParticipant.php`

**Description:** G√®re les participants avec leurs r√¥les et statuts de pr√©sence.

**Constantes ENUM:**
- `ROLE_PRESIDENT`, `ROLE_SECRETAIRE`, `ROLE_PARTICIPANT`, `ROLE_OBSERVATEUR`, `ROLE_INVITE`
- `TYPE_INTERNE`, `TYPE_EXTERNE`
- `STATUT_PRESENCE_INVITE`, `STATUT_PRESENCE_CONFIRME`, `STATUT_PRESENCE_REFUSE`, `STATUT_PRESENCE_ABSENT`, `STATUT_PRESENCE_PRESENT`

**Relations principales:**
- `reunion()` - BelongsTo vers Reunion
- `user()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `confirmes()`, `presents()`, `absents()`, `refuses()`, `byRole()`, `byType()`
- Accesseurs: `roleLibelle`, `typeLibelle`, `statutPresenceLibelle`
- M√©thodes: `estPresent`, `estConfirme`, `estPresident`, `estSecretaire`

---

### 5. **ReunionPV** - Proc√®s-verbaux
**Fichier:** `app/Models/ReunionPV.php`

**Description:** G√®re les proc√®s-verbaux avec versioning et validation.

**Constantes ENUM:**
- `STATUT_BROUILLON`, `STATUT_VALIDE`, `STATUT_PUBLIE`

**Relations principales:**
- `reunion()` - BelongsTo vers Reunion
- `redacteur()` - BelongsTo vers User
- `validateur()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `brouillons()`, `valides()`, `publies()`, `byVersion()`, `dernieresVersions()`
- Accesseurs: `statutLibelle`, `statutCouleur`, `statutIcone`
- M√©thodes: `nombreMots`, `nombreCaracteres`, `extrait`, `dureeRedaction`, `tempsValidation`

---

### 6. **TypeReunionValidateurPV** - Validateurs de PV
**Fichier:** `app/Models/TypeReunionValidateurPV.php`

**Description:** Configure qui peut valider les PV par type de r√©union.

**Relations principales:**
- `typeReunion()` - BelongsTo vers TypeReunion
- `user()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `actifs()`, `byNiveauValidation()`, `byTypeReunion()`

---

### 7. **ReunionNotificationConfig** - Configuration des notifications
**Fichier:** `app/Models/ReunionNotificationConfig.php`

**Description:** Configure les notifications par type de r√©union.

**Constantes ENUM:**
- `TYPE_CONFIRMATION_PRESENCE`, `TYPE_RAPPEL`, `TYPE_PV_DISPONIBLE`, `TYPE_RAPPEL_ACTIONS`

**Relations principales:**
- `typeReunion()` - BelongsTo vers TypeReunion
- `createur()` - BelongsTo vers User
- `modificateur()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `actives()`, `byTypeNotification()`, `byTypeReunion()`
- Accesseurs: `typeNotificationLibelle`, `delaiFormate`, `destinatairesFormates`
- M√©thodes: `hasDestinataire()`, `getConfigurationAvancee()`

---

### 8. **ReunionGeneree** - R√©unions g√©n√©r√©es automatiquement
**Fichier:** `app/Models/ReunionGeneree.php`

**Description:** Tra√ßabilit√© des r√©unions g√©n√©r√©es depuis les s√©ries.

**Constantes ENUM:**
- `STATUT_GENERE`, `STATUT_PLANIFIEE`, `STATUT_ANNULEE`

**Relations principales:**
- `serie()` - BelongsTo vers ReunionSerie
- `reunion()` - BelongsTo vers Reunion

**Fonctionnalit√©s:**
- Scopes: `byStatut()`, `bySerie()`
- Accesseurs: `statutLibelle`

---

### 9. **ReunionNotification** - Notifications envoy√©es
**Fichier:** `app/Models/ReunionNotification.php`

**Description:** Tra√ßabilit√© des notifications envoy√©es aux participants.

**Constantes ENUM:**
- `TYPE_CONFIRMATION_PRESENCE`, `TYPE_RAPPEL`, `TYPE_PV_DISPONIBLE`, `TYPE_RAPPEL_ACTIONS`
- `STATUT_ENVOYEE`, `STATUT_ECHEC`, `STATUT_LUE`

**Relations principales:**
- `reunion()` - BelongsTo vers Reunion
- `destinataire()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `byType()`, `byStatut()`, `envoyees()`, `lues()`, `echecs()`
- Accesseurs: `typeLibelle`, `statutLibelle`, `statutCouleur`, `statutIcone`
- M√©thodes: `tempsLecture`

---

### 10. **ReunionWorkflowConfig** - Configuration des workflows
**Fichier:** `app/Models/ReunionWorkflowConfig.php`

**Description:** Configure les workflows par type de r√©union.

**Relations principales:**
- `typeReunion()` - BelongsTo vers TypeReunion
- `executions()` - HasMany vers ReunionWorkflowExecution
- `createur()` - BelongsTo vers User
- `modificateur()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `actifs()`, `byTypeReunion()`
- Accesseurs: `nombreEtapes`, `etapesFormatees`

---

### 11. **ReunionWorkflowExecution** - Ex√©cution des workflows
**Fichier:** `app/Models/ReunionWorkflowExecution.php`

**Description:** Suivi de l'ex√©cution des workflows par r√©union.

**Constantes ENUM:**
- `STATUT_EN_COURS`, `STATUT_TERMINE`, `STATUT_BLOQUE`, `STATUT_ANNULE`

**Relations principales:**
- `reunion()` - BelongsTo vers Reunion
- `workflowConfig()` - BelongsTo vers ReunionWorkflowConfig

**Fonctionnalit√©s:**
- Scopes: `byStatut()`, `enCours()`, `termines()`, `bloques()`
- Accesseurs: `statutLibelle`, `statutCouleur`, `statutIcone`
- M√©thodes: `dureeExecution`, `progression`, `etapeActuelleFormatee`

---

### 12. **ReunionOrdreJour** - Ordre du jour
**Fichier:** `app/Models/ReunionOrdreJour.php`

**Description:** Points de l'ordre du jour avec types et dur√©es.

**Constantes ENUM:**
- `TYPE_PRESENTATION`, `TYPE_DISCUSSION`, `TYPE_DECISION`, `TYPE_INFORMATION`, `TYPE_PAUSE`
- `STATUT_PLANIFIE`, `STATUT_EN_COURS`, `STATUT_TERMINE`, `STATUT_REPORTE`

**Relations principales:**
- `reunion()` - BelongsTo vers Reunion
- `responsable()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `byType()`, `byStatut()`, `ordered()`
- Accesseurs: `typeLibelle`, `statutLibelle`, `dureeFormatee`, `typeCouleur`, `typeIcone`

---

### 13. **ReunionDecision** - D√©cisions prises
**Fichier:** `app/Models/ReunionDecision.php`

**Description:** D√©cisions prises lors des r√©unions avec responsables et priorit√©s.

**Constantes ENUM:**
- `PRIORITE_FAIBLE`, `PRIORITE_NORMALE`, `PRIORITE_ELEVEE`, `PRIORITE_CRITIQUE`
- `STATUT_A_FAIRE`, `STATUT_EN_COURS`, `STATUT_TERMINE`, `STATUT_ANNULE`

**Relations principales:**
- `reunion()` - BelongsTo vers Reunion
- `responsable()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `byStatut()`, `byPriorite()`, `enRetard()`
- Accesseurs: `prioriteLibelle`, `statutLibelle`, `prioriteCouleur`, `prioriteIcone`
- M√©thodes: `estEnRetard`

---

### 14. **ReunionAction** - Actions de suivi
**Fichier:** `app/Models/ReunionAction.php`

**Description:** Actions de suivi avec progression et pi√®ces jointes.

**Constantes ENUM:**
- `PRIORITE_FAIBLE`, `PRIORITE_NORMALE`, `PRIORITE_ELEVEE`, `PRIORITE_CRITIQUE`
- `STATUT_A_FAIRE`, `STATUT_EN_COURS`, `STATUT_TERMINE`, `STATUT_ANNULE`

**Relations principales:**
- `reunion()` - BelongsTo vers Reunion
- `responsable()` - BelongsTo vers User

**Fonctionnalit√©s:**
- Scopes: `byStatut()`, `byPriorite()`, `enRetard()`
- Accesseurs: `prioriteLibelle`, `statutLibelle`, `progressionFormatee`
- M√©thodes: `estEnRetard`, `estTerminee`

---

### 15. **ReunionSujet** - Sujets discut√©s
**Fichier:** `app/Models/ReunionSujet.php`

**Description:** Sujets discut√©s lors des r√©unions avec niveaux de difficult√©.

**Constantes ENUM:**
- `DIFFICULTE_FACILE`, `DIFFICULTE_MOYENNE`, `DIFFICULTE_DIFFICILE`
- `STATUT_A_DISCUTER`, `STATUT_EN_DISCUSSION`, `STATUT_RESOLU`, `STATUT_REPORTE`

**Relations principales:**
- `reunion()` - BelongsTo vers Reunion
- `objectifs()` - HasMany vers ReunionSujetObjectif

**Fonctionnalit√©s:**
- Scopes: `byDifficulte()`, `byStatut()`, `avecObjectifs()`, `avecDifficultes()`
- Accesseurs: `difficulteLibelle`, `statutLibelle`, `difficulteCouleur`, `difficulteIcone`

---

### 16. **ReunionSujetObjectif** - Objectifs par sujet
**Fichier:** `app/Models/ReunionSujetObjectif.php`

**Description:** Objectifs associ√©s aux sujets avec progression.

**Constantes ENUM:**
- `STATUT_A_ATTEINDRE`, `STATUT_EN_COURS`, `STATUT_ATTEINT`, `STATUT_ANNULE`

**Relations principales:**
- `sujet()` - BelongsTo vers ReunionSujet
- `difficultes()` - HasMany vers ReunionObjectifDifficulte

**Fonctionnalit√©s:**
- Scopes: `byStatut()`, `enRetard()`
- Accesseurs: `statutLibelle`, `progressionFormatee`, `statutCouleur`, `statutIcone`
- M√©thodes: `estEnRetard`, `estAtteint`

---

### 17. **ReunionObjectifDifficulte** - Difficult√©s par objectif
**Fichier:** `app/Models/ReunionObjectifDifficulte.php`

**Description:** Difficult√©s rencontr√©es pour atteindre les objectifs.

**Constantes ENUM:**
- `IMPACT_FAIBLE`, `IMPACT_MOYEN`, `IMPACT_ELEVE`, `IMPACT_CRITIQUE`
- `STATUT_A_RESOUDRE`, `STATUT_EN_COURS`, `STATUT_RESOLU`, `STATUT_ANNULE`

**Relations principales:**
- `objectif()` - BelongsTo vers ReunionSujetObjectif
- `entite()` - BelongsTo vers Entite

**Fonctionnalit√©s:**
- Scopes: `byImpact()`, `byStatutResolution()`, `nonResolues()`
- Accesseurs: `impactLibelle`, `statutResolutionLibelle`, `impactCouleur`, `impactIcone`
- M√©thodes: `estResolue`, `estCritique`

---

## üîó Relations Ajout√©es au Mod√®le User

Le mod√®le `User` a √©t√© enrichi avec de nombreuses relations vers les r√©unions :

### Relations Many-to-Many
- `typesReunionsGeres()` - Types de r√©unions g√©r√©s
- `typesReunionsMembrePermanent()` - Types o√π membre permanent

### Relations One-to-Many
- `typesReunionsValidateurPV()` - Types o√π peut valider PV
- `seriesReunionsCreees()` - S√©ries cr√©√©es
- `reunionsCreees()` - R√©unions cr√©√©es
- `reunionsModifiees()` - R√©unions modifi√©es
- `reunionsParticipant()` - Participations
- `reunionsPresident()` - Pr√©sidences
- `reunionsSecretaire()` - Secr√©tariats
- `pvsRediges()` - PV r√©dig√©s
- `pvsValides()` - PV valid√©s
- `reunionsPVValidees()` - R√©unions avec PV valid√©s
- `notificationsReunions()` - Notifications re√ßues
- `configsNotificationsCreees()` - Configs cr√©√©es
- `configsNotificationsModifiees()` - Configs modifi√©es
- `workflowsReunionsCrees()` - Workflows cr√©√©s
- `workflowsReunionsModifies()` - Workflows modifi√©s
- `ordresJourResponsable()` - Ordres du jour responsables
- `decisionsReunionsResponsable()` - D√©cisions responsables
- `actionsReunionsResponsable()` - Actions responsables

### M√©thodes Utilitaires
- `reunionsImpliquees()` - Toutes les r√©unions impliqu√©es
- `peutGererTypeReunion()` - V√©rification permissions gestion
- `estMembrePermanentTypeReunion()` - V√©rification membre permanent
- `peutValiderPVTypeReunion()` - V√©rification validation PV

## üé® Fonctionnalit√©s Communes

### Traits Utilis√©s
- `HasFactory` - Pour les factories de test
- `Auditable` - Pour la tra√ßabilit√© des modifications

### Patterns Communs
- **Timestamps personnalis√©s:** `date_creation`, `date_modification`
- **Audit:** `creer_par`, `modifier_par`
- **Scopes de requ√™te:** Pour filtrer facilement
- **Accesseurs:** Pour formater les donn√©es
- **Constantes ENUM:** Pour les valeurs pr√©d√©finies
- **Couleurs et ic√¥nes:** Pour l'interface utilisateur

### Casts JSON
- `fonctionnalites_actives` - Configuration flexible
- `configuration_recurrence` - Param√®tres de r√©currence
- `notifications_actives` - Pr√©f√©rences de notification
- `pieces_jointes` - Fichiers attach√©s
- `commentaires` - Commentaires structur√©s

## üöÄ Utilisation

### Exemple d'utilisation basique
```php
// Cr√©er un type de r√©union
$typeReunion = TypeReunion::create([
    'nom' => 'Comit√© de Direction',
    'niveau_complexite' => TypeReunion::NIVEAU_COMPLEXE,
    'actif' => true
]);

// Cr√©er une r√©union
$reunion = Reunion::create([
    'titre' => 'R√©union mensuelle',
    'type_reunion_id' => $typeReunion->id,
    'date_debut' => now()->addDays(7),
    'date_fin' => now()->addDays(7)->addHours(2),
    'statut' => Reunion::STATUT_PLANIFIEE
]);

// Ajouter des participants
$reunion->participants()->create([
    'user_id' => $user->id,
    'role' => ReunionParticipant::ROLE_PRESIDENT,
    'statut_presence' => ReunionParticipant::STATUT_INVITE
]);
```

### Exemple de requ√™tes complexes
```php
// R√©unions √† venir pour un utilisateur
$reunionsAVenir = $user->reunionsParticipant()
    ->with('reunion')
    ->whereHas('reunion', function($q) {
        $q->aVenir()->nonSuspendues();
    })
    ->get();

// PV en attente de validation
$pvEnAttente = ReunionPV::brouillons()
    ->whereHas('reunion.typeReunion.validateursPV', function($q) use ($user) {
        $q->where('user_id', $user->id)->actifs();
    })
    ->get();
```

## üìù Notes Importantes

1. **Tous les mod√®les utilisent des timestamps personnalis√©s** (`date_creation`, `date_modification`)
2. **Tous les mod√®les incluent l'audit** (`creer_par`, `modifier_par`)
3. **Les relations sont optimis√©es** avec des cl√©s √©trang√®res appropri√©es
4. **Les scopes facilitent les requ√™tes** courantes
5. **Les accesseurs formatent automatiquement** les donn√©es pour l'affichage
6. **Les constantes ENUM** assurent la coh√©rence des donn√©es
7. **Les couleurs et ic√¥nes** sont pr√™tes pour l'interface utilisateur

## üîÑ Prochaines √âtapes

1. **Cr√©er les contr√¥leurs** pour chaque mod√®le
2. **Impl√©menter les services** m√©tier
3. **Cr√©er les seeders** pour les donn√©es de test
4. **D√©velopper l'interface frontend**
5. **Ajouter les tests unitaires**
6. **Impl√©menter les notifications** automatiques
7. **Cr√©er les rapports** et statistiques 
